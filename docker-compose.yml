services:
  scheduler:
    build:
      context: .
      dockerfile: docker/scheduler/Dockerfile
    container_name: oiat-scheduler
    working_dir: /app
    command: ["python", "manage.py", "run_schedule_worker"]
    env_file:
      - .env
    environment:
      OIAT_SCHEDULER_POLL_SECONDS: ${OIAT_SCHEDULER_POLL_SECONDS:-15}
      OIAT_SCHEDULER_ENABLE_ENV_FALLBACK: ${OIAT_SCHEDULER_ENABLE_ENV_FALLBACK:-1}
      SCHEDULE_CRON: ${SCHEDULE_CRON:-0 18 * * *}
      SCHEDULE_TZ: ${SCHEDULE_TZ:-Africa/Lagos}
    volumes:
      - .:/app
    restart: unless-stopped
    init: true
